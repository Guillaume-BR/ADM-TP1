\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{dsfont}
\usepackage{graphicx} % Required for inserting images
\usepackage{listings}
\usepackage{array}
\usepackage[vmargin=0.5cm]{geometry}


\title{TP1-ADM}
\author{Guillaume Bernard-Reymond et Lorenzo Gaggini}
\date{October 2023}

\begin{document}
\newcommand{\norme}[1]{\left\| #1\right\|}

\maketitle

\section{Partie 1}
Dans cette partie, nous désignerons par $(x_{i})$ où $i\in\{1;...;21\}$ les individus et $(x^{j})$ où $j\in\{1;...;32\}$ les variables, qu'elles soient quantitatives ou bien qualitatives. Enfin nous noterons $(z^{j})$ où $j\in\{4;...;32\}$ les variables quantitatives centrées-réduites.  
\begin{enumerate}
    \item Dans cette question nous placerons dans le cas général où $i\in\{1;...;n\}$ et $j\in\{1;...;p\}$
    \begin{itemize}
        \item[$\bullet$] On considère $(w_{i})_{i\in\{1...n\}}$ une suite de poids telle que $\displaystyle\sum_{i=1}^{n}=1$ et soit $j\in\{1;...;p\}$. On peut alors écrire : 
        \begin{align*}
            \sum_{i=1}^{n} w_i z_i^j = & \sum_{i=1}^{n} w_i \left(\dfrac{x_i^j-\overline{x^j}}{\sigma_{x^j}}\right)\\
            =& \dfrac{1}{\sigma_{x^j}}\sum_{i=1}^{n}\left(w_i x_{i}^j-w_i \overline{x^j}\right) \\
            =&\dfrac{1}{\sigma_{x^j}} \left(\overline{x^j}-\overline{x^j}\sum_{i=1}^{n} w_i\right)\\
            =& 0
        \end{align*}
    Le barycentre du nuage est donc bien $0_{\mathbb{R}^{p}}$.
    
    Informatiquement, nous avons utiliser les commandes suivantes : 
\begin{lstlisting}[language=R]
Barycentre=(colMeans(CR[4:32]))
print(Barycentre)
\end{lstlisting}    
Les résultats obtenus étant de l'ordre de $10^{-16}$, on peut considérer qu'ils sont égaux à $0$.

    \item[$\bullet$] 
    \begin{align*}
       In_{O}\left(\{z_i;w_i\}_{i=1,...,n}\right) = & \sum_{i=1}^{n} w_i \norme{z_{i}}^2 \\
       = & \sum_{i=1}^{n} w_i \left(\sum_{j=1}^p {z_i^j}^2\right)\\
       =& \sum_{i=1}^{n} \left(\sum_{j=1}^p w_i {z_i^j}^2\right) \\
       =& \sum_{j=1}^p \left( \sum_{i=1}^{n}w_i {z_i^j}^2\right)
    \end{align*}
    Or l'expression $\displaystyle \sum_{i=1}^{n}w_i {z_i^j}^2$ n'est rien d'autre que l'expression de la variance de notre variable quantitative centrée réduite qui vaut donc $1$. 

    Ainsi : $In_{O}\left(\{z_i;w_i\}_{i=1,...,n}\right) = p$ c'est à dire le nombre de variables quantitatives.
    
    Informatiquement, nous avons utilisé les commandes :
\begin{lstlisting}[language=R]  
#variance 
Variance=diag(var(CR[4:32]))
print(Variance)

#inertia
Inertie=sum(Variance)
print(Inertie)
\end{lstlisting}

Le résultat obtenu est 29 comme attendu.
    \end{itemize}

\item Pour chaque appellation, nous avons effectuer un tri afin d'obtenir pour chaque appellation un tableau des individus. A partir de là, nous avons calculé le poids, les barycentres et les normes euclidiennes carrées de ces trois barycentres. Voici le code utilisé où CR désigne le tableau dont les variables quantitatives sont centrées et réduites : 

\begin{lstlisting}[language=R]
"Q2"
chinon=CR[CR$Label == 'Chinon',]
saumur=CR[CR$Label == 'Saumur',]
bourgueuil=CR[CR$Label == 'Bourgueuil',]

#poids
pchi=nrow(chinon)/nrow(CR)
psau=nrow(saumur)/nrow(CR)
pbou=nrow(bourgueuil)/nrow(CR)

#barycentre
mchi= unname(colMeans(chinon[4:32]))
msau= unname(colMeans(saumur[4:32]))
mbou= unname(colMeans(bourgueuil[4:32]))

#carree des normes euclidiennes des barycentres
nchi=sum(mchi^2)
nsau=sum(msau^2)
nbou=sum(mbou^2)
\end{lstlisting}

Voici les résultats obtenus : 

% \usepackage{array} is required
\begin{tabular}{|l|>{\centering\arraybackslash}p{3cm}|>{\centering\arraybackslash}p{3cm}|}
\hline 
 & Poids & Norme \\ 
\hline 
Chinon & 0,1905 & 5,1428 \\ 
\hline 
Saumur & 0,5338 & 2,0188 \\ 
\hline 
Bourgueuil & 0,2857 & 3,4319 \\ 
\hline 
\end{tabular} 

Pour chaque variable sensorielle, nous avons calculer le $R^2$. Nous avons donc obtenu $3$ vecteurs lignes de $29$ valeurs. Nous avons ensuite triés les valeurs et tracés les graphiques correspondant.

Pour le Bourgueil :
\begin{itemize}
\item[$\bullet$] la moins liée : Spice.before.shaking
\item[$\bullet$] la plus liée : Attack.intensity  
\end{itemize}

Pour le Chinon :
\begin{itemize}
\item[$\bullet$] les moins liées : Spice.before.shaking et Astringency 
\item[$\bullet$] les plus liées par ordre croissant : Fruity , Aroma.intensity , Acidity   
\end{itemize}

Pour le Saumur :
\begin{itemize}
\item[$\bullet$] la moins liée : Surface.feeling 
\item[$\bullet$] les plus liées par ordre croissant : Flower , Spice , Spice.before.shaking. 
\end{itemize}

A montrer : le $R^2$ de la partition est égal à la moyenne arithmétique des $R^2$ des variables.
\end{enumerate}

\section{Partie 2}

\begin{enumerate}
\item 
	\begin{enumerate}
	\item On considère le vecteur $\mathds{1}_n=\begin{pmatrix}
	1 \\ 
	\vdots \\ 
	 \\ 
	1
	\end{pmatrix} \in\mathbb{R}^{n}$.\\
	 On rappelle que $\mathds{1}_n\in \text{Vect}\left(y^1;...;y^p\right)=\langle Y \rangle$ car $\forall i\in\{1;...;n\},\, \sum_{j=1}^p \mathds{1}_{Y_i=j}=1$ donc $\mathds{1}_n\in \langle Y \rangle$.
Soit $j\in\{1;...;p\}$ :
	\begin{align*}
	\Pi_{\langle Y \rangle} x^j =& \Pi_{\langle\mathds{1}_n\rangle}x^j +\Pi_{\langle \mathds{1}_n^{\perp} \cap Y \rangle} x^j  \text{ car } \langle Y \rangle = \langle \mathds{1}_n \rangle \overset{\perp}{\oplus}\langle \mathds{1}_n^{\perp} \cap Y \rangle \\
	  =& 0 + \Pi_{\langle Y^c \rangle} x^j \\
	  =& \Pi_{\langle Y^c \rangle} x^j
	\end{align*}
 $\Pi_{\langle\mathds{1}_n\rangle}x^j=0$ car $x^j$ étant centré réduit, il appartient à $\mathds{1}_n^{\perp}$.\\
 
	
	$\norme{\Pi_Yx^j}^2_{W}$ représente la variance de la variable $x^j$ par rapport à l'appellation.
	\item $\Pi_Y=Y\left(Y'WY\right)^{-1}Y'W$ est une matrice carrée de taille $21$ et de même pour $\Pi_{x^j}=x^{j}\left({x^{j}}'Wx^{j}\right)^{-1}{x^{j}}'W$
	
	\item $\text{tr}(R \Pi_Y)$ est le $R^2$ de la partition des vins en appellations.
	
	\item 
	\end{enumerate}

\item De la même façon, $\text{tr}(\Pi_{x^j}\Pi_{Z})$ est ... et $\text{tr}(R\Pi_{Z})$ est le $R^2$ de la partition des vins selon les types de sol.
\end{enumerate}

\end{document}
